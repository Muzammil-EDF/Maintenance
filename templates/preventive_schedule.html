{% extends "base.html" %}
{% block body %}
<div class="container mt-4">
  <h3>Preventive Maintenance Schedule - {{ building }}</h3>
  <p><strong>Total Machines:</strong> {{ schedule|length }}</p>
  <p><strong>Per Day:</strong> {{ per_day }} machines</p>
  <div class="">
    <a href="{{ url_for('download_schedule', building=building) }}" class="btn btn-dark btn-sm">
      Download Excel
    </a>
  </div>



  {% if schedule %}
  <table class="table table-bordered machine-table">
    <thead>
      <tr>
        <!-- <th>Category</th> -->
        <th>Brand</th>
        <th>Model</th>
        <th>Tag No</th>
        <th>Serial/Mfg</th>
        <th>Description</th>
        <th>Building</th>
        <th>Floor</th>
        <th>Preventive Date</th>
      </tr>
    </thead>
    <tbody>
      {% for row in schedule %}
      <tr>
        <!-- <td>{{ row.category }}</td> -->
        <td>{{ row.brand }}</td>
        <td>{{ row.model }}</td>
        <td>{{ row.tag }}</td>
        <td>{{ row.serial }}</td>
        <td>{{ row.desc }}</td>
        <td>{{ row.building }}</td>
        <td>{{ row.floor }}</td>
        <td>{{ row.preventive_date }}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
  {% else %}
  <div class="alert alert-info">No schedule generated.</div>
  {% endif %}
</div>

<script>
  $(document).ready(function () {
    $('.machine-table').DataTable({
      paging: false, // ✅ Disable pagination
      scrollY: '600px', // ✅ Optional: scrollable view
      scrollCollapse: true,
      initComplete: function () {
        this.api().columns().every(function () {
          var column = this;
          $('input', this.header()).on('keyup change clear', function () {
            if (column.search() !== this.value) {
              column.search(this.value).draw();
            }
          });
        });
      }
    });
  });
</script>

{% endblock body %}